<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Heatmaps for species analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Heatmaps_for_species_files/libs/clipboard/clipboard.min.js"></script>
<script src="Heatmaps_for_species_files/libs/quarto-html/quarto.js"></script>
<script src="Heatmaps_for_species_files/libs/quarto-html/popper.min.js"></script>
<script src="Heatmaps_for_species_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Heatmaps_for_species_files/libs/quarto-html/anchor.min.js"></script>
<link href="Heatmaps_for_species_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Heatmaps_for_species_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Heatmaps_for_species_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Heatmaps_for_species_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Heatmaps_for_species_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="Heatmaps_for_species_files/libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="Heatmaps_for_species_files/libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="Heatmaps_for_species_files/libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#making-heatmaps-from-species-analysis" id="toc-making-heatmaps-from-species-analysis" class="nav-link active" data-scroll-target="#making-heatmaps-from-species-analysis">Making heatmaps from species analysis</a>
  <ul class="collapse">
  <li><a href="#dowloading-the-table-from-galaxy-and-renaming" id="toc-dowloading-the-table-from-galaxy-and-renaming" class="nav-link" data-scroll-target="#dowloading-the-table-from-galaxy-and-renaming">Dowloading the table from galaxy and renaming</a></li>
  <li><a href="#using-positcloud-for-r-projects" id="toc-using-positcloud-for-r-projects" class="nav-link" data-scroll-target="#using-positcloud-for-r-projects">Using PositCloud for R projects</a></li>
  <li><a href="#reading-the-file-and-replacing-nas-with-0" id="toc-reading-the-file-and-replacing-nas-with-0" class="nav-link" data-scroll-target="#reading-the-file-and-replacing-nas-with-0">Reading the file and replacing NAs with 0</a></li>
  <li><a href="#select-top-n-species-or-a-selection-of-species" id="toc-select-top-n-species-or-a-selection-of-species" class="nav-link" data-scroll-target="#select-top-n-species-or-a-selection-of-species">Select top n species, or a selection of species</a>
  <ul class="collapse">
  <li><a href="#choose-top-values-based-on-abundance-value-for-a-particular-column" id="toc-choose-top-values-based-on-abundance-value-for-a-particular-column" class="nav-link" data-scroll-target="#choose-top-values-based-on-abundance-value-for-a-particular-column">1. Choose top values based on abundance value for a particular column</a></li>
  <li><a href="#choose-rows-based-on-species-name" id="toc-choose-rows-based-on-species-name" class="nav-link" data-scroll-target="#choose-rows-based-on-species-name">2. Choose rows based on species name</a></li>
  </ul></li>
  <li><a href="#simple-heatmap" id="toc-simple-heatmap" class="nav-link" data-scroll-target="#simple-heatmap">Simple heatmap</a></li>
  <li><a href="#ggplot2-heatmap" id="toc-ggplot2-heatmap" class="nav-link" data-scroll-target="#ggplot2-heatmap">ggplot2 heatmap</a></li>
  <li><a href="#ggplot2-colour-schemes" id="toc-ggplot2-colour-schemes" class="nav-link" data-scroll-target="#ggplot2-colour-schemes">ggplot2 colour schemes</a>
  <ul class="collapse">
  <li><a href="#colour-based-on-named-colours-or-html-codes" id="toc-colour-based-on-named-colours-or-html-codes" class="nav-link" data-scroll-target="#colour-based-on-named-colours-or-html-codes">1. Colour based on named colours or html codes</a></li>
  <li><a href="#colour-based-on-palette" id="toc-colour-based-on-palette" class="nav-link" data-scroll-target="#colour-based-on-palette">2. Colour based on palette</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Heatmaps for species analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="making-heatmaps-from-species-analysis" class="level1">
<h1>Making heatmaps from species analysis</h1>
<p>A few of you have asked how to go from the species analysis tables in galaxy to generating heatmaps. This can be done in R, so find below a short guide to setting these up.</p>
<p><em>This is entirely optional - it is perfectly okay to display the same information in an excel table</em></p>
<section id="dowloading-the-table-from-galaxy-and-renaming" class="level2">
<h2 class="anchored" data-anchor-id="dowloading-the-table-from-galaxy-and-renaming">Dowloading the table from galaxy and renaming</h2>
<p>We can save the species abundance table from galaxy - this is a tsv file (tab separated file) but it is renamed as a tabular file. You can rename this to remove the .tabular and leave it as a .tsv file.</p>
<p><em>I’m working on a Mac but it is the same for Windows</em></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="heatmap7_savegalaxy.gif" class="lightbox" data-gallery="my-gallery" title="Download Abundance File"><img src="heatmap7_savegalaxy.gif" class="img-fluid figure-img" alt="Download Abundance File"></a></p>
<figcaption>Download Abundance File</figcaption>
</figure>
</div>
</section>
<section id="using-positcloud-for-r-projects" class="level2">
<h2 class="anchored" data-anchor-id="using-positcloud-for-r-projects">Using PositCloud for R projects</h2>
<p>Create a <strong>free</strong> account on <a href="https://posit.cloud/">posit.cloud</a> to access R and all packages. Like Galaxy, this is a cloud-based solution so the actual analyses is run on a remote server. Therefore this should work from any device.</p>
<p><em>You will not need a paid plan for this project</em></p>
<p>Once you’ve created an account:</p>
<ol type="1">
<li>Log in and open up a new RStudio Project.</li>
<li>Use the upload button to upload your abundance file</li>
<li>Create and save a new R file (top left panel)</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="heatmap1_posit.gif" class="lightbox" data-gallery="my-gallery" title="Set up RStudio project"><img src="heatmap1_posit.gif" class="img-fluid figure-img" alt="Set up RStudio project"></a></p>
<figcaption>Set up RStudio project</figcaption>
</figure>
</div>
</section>
<section id="reading-the-file-and-replacing-nas-with-0" class="level2">
<h2 class="anchored" data-anchor-id="reading-the-file-and-replacing-nas-with-0">Reading the file and replacing NAs with 0</h2>
<p>First, we need to read the data from the file and store it.</p>
<p>We can create save our results as a variable (like a container) with code like: <code>variable_name &lt;- task()</code> which save the results of a task or function as variable_name.</p>
<ol type="1">
<li>Use the following R code, changing FILENAME to your filename. This will open your file and save it as a variable called my_species_abundance_data</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>my_species_abundance_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"FILENAME.tsv"</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Use the following R code to replace all NAs with 0s</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_species_abundance_data[<span class="fu">is.na</span>(my_species_abundance_data)] <span class="ot">&lt;-</span> <span class="dv">0</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="heatmap2_readfile.gif" class="lightbox" data-gallery="my-gallery" title="Open datasets"><img src="heatmap2_readfile.gif" class="img-fluid figure-img" alt="Open datasets"></a></p>
<figcaption>Open datasets</figcaption>
</figure>
</div>
</section>
<section id="select-top-n-species-or-a-selection-of-species" class="level2">
<h2 class="anchored" data-anchor-id="select-top-n-species-or-a-selection-of-species">Select top n species, or a selection of species</h2>
<p>Next, choose what data you want to plot on your heatmap. The full datasets are too large!</p>
<p>There are different ways you can do this:</p>
<section id="choose-top-values-based-on-abundance-value-for-a-particular-column" class="level3">
<h3 class="anchored" data-anchor-id="choose-top-values-based-on-abundance-value-for-a-particular-column">1. Choose top values based on abundance value for a particular column</h3>
<p>For this we can use the dplyr package, which has a function called top_n.&nbsp; You need to change the words in capital letters to match what you want to choose.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load the package</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'dplyr'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The below code is selecting for the top 10 values in column </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>my_species_top_n_sample_1 <span class="ot">&lt;-</span> <span class="fu">top_n</span>(NAME_OF_DATA,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                                NUMBER_OF_TOP_VALUES_TO_PICK,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                                COLUMN_NAME_FOR_SELECTION)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="heatmap3_top_n.gif" class="lightbox" data-gallery="my-gallery" title="Select data from dataset based on top values"><img src="heatmap3_top_n.gif" class="img-fluid figure-img" alt="Select data from dataset based on top values"></a></p>
<figcaption>Select data from dataset based on top values</figcaption>
</figure>
</div>
</section>
<section id="choose-rows-based-on-species-name" class="level3">
<h3 class="anchored" data-anchor-id="choose-rows-based-on-species-name">2. Choose rows based on species name</h3>
<p>You can create a vector containing all the species names you want to extract from your table, and use this to create a new dataframe based on these species. Spelling must match row names exactly. I’ve picked 5 at random below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose species. </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>my_species <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Baekduia soli'</span>, <span class="st">'Brevibacillus panacihumi'</span>, <span class="st">'Campylobacter jejuni'</span>, <span class="st">'Caulobacter flavus'</span>, <span class="st">'Dehalogenimonas lykanthroporepellens'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select species from row</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>my_species_chosen_selection <span class="ot">&lt;-</span> my_species_abundance_data[my_species,] <span class="co"># the comma is important here, it selects all columns for the chosen rows. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="heatmap4_chosen.gif" class="lightbox" data-gallery="my-gallery" title="Select data from dataset based on species names"><img src="heatmap4_chosen.gif" class="img-fluid figure-img" alt="Select data from dataset based on species names"></a></p>
<figcaption>Select data from dataset based on species names</figcaption>
</figure>
</div>
</section>
</section>
<section id="simple-heatmap" class="level2">
<h2 class="anchored" data-anchor-id="simple-heatmap">Simple heatmap</h2>
<p>Use the heatmap() and legend() functions to make a simple heatmap with R functions. You can then edit the labels and formatting in another program (such as on a powerpoint slide).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change my_species_chosen_selection to the name of your dataframe, e.g. my_species_top_n_sample_1</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(<span class="fu">as.matrix</span>(my_species_chosen_selection))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend with three colours</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="st">"left"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"mini"</span>, <span class="st">"med"</span>, <span class="st">"max"</span>),<span class="at">fill=</span><span class="fu">heat.colors</span>(<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="heatmap4_simpleheatmap.gif" class="lightbox" data-gallery="my-gallery" title="Simple heatmap and legend"><img src="heatmap4_simpleheatmap.gif" class="img-fluid figure-img" alt="Simple heatmap and legend"></a></p>
<figcaption>Simple heatmap and legend</figcaption>
</figure>
</div>
</section>
<section id="ggplot2-heatmap" class="level2">
<h2 class="anchored" data-anchor-id="ggplot2-heatmap">ggplot2 heatmap</h2>
<p>This heat map gives a bit more control over the colour and legends, but requires an few extra steps. We have to first “melt” the data so that the species name and sample name are both in columns.</p>
<p>First, install and load the packages ggplot2 and reshape2:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load packages</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'ggplot2'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'reshape2'</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, reformatted into a melted form. This will give you a column for species names, a column for which sample and a column for the abundance value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>species_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">as.matrix</span>(my_species_chosen_selection))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we can create a ggplot based on our data:</p>
<p>I suggest putting the samples on the X axis and species on the Y axis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(species_melted, <span class="fu">aes</span>(<span class="at">x =</span> COLUMN_SAMPLES, <span class="at">y=</span>COLUMN_SPECIES, <span class="at">fill =</span> value)) <span class="sc">+</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Title of graph"</span>, <span class="at">x =</span> <span class="st">"X axis label"</span>, <span class="at">y =</span> <span class="st">"Y axis label"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="heatmap5_ggplot2.gif" class="lightbox" data-gallery="my-gallery" title="Simple heatmap and legend"><img src="heatmap5_ggplot2.gif" class="img-fluid figure-img" alt="Simple heatmap and legend"></a></p>
<figcaption>Simple heatmap and legend</figcaption>
</figure>
</div>
</section>
<section id="ggplot2-colour-schemes" class="level2">
<h2 class="anchored" data-anchor-id="ggplot2-colour-schemes">ggplot2 colour schemes</h2>
<p>With ggplot2, you can add either of the following lines to change the colours of the graph</p>
<section id="colour-based-on-named-colours-or-html-codes" class="level3">
<h3 class="anchored" data-anchor-id="colour-based-on-named-colours-or-html-codes">1. Colour based on named colours or html codes</h3>
<p>The line <code>scale_fill_gradient(high = "red", low = "yellow")</code> allows you to choose the high and low colours for a gradient based on <a href="https://sape.inf.usi.ch/quick-reference/ggplot2/colour">ggplot named colours</a></p>
<p>For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(species_melted, <span class="fu">aes</span>(<span class="at">x =</span> COLUMN_SAMPLES, <span class="at">y=</span>COLUMN_SPECIES, <span class="at">fill =</span> value)) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add new line here with + at the end </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">high =</span> <span class="st">"lavenderblush1"</span>, <span class="at">low =</span> <span class="st">"darkorchid4"</span>) <span class="sc">+</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Title of graph"</span>, <span class="at">x =</span> <span class="st">"X axis label"</span>, <span class="at">y =</span> <span class="st">"Y axis label"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="colour-based-on-palette" class="level3">
<h3 class="anchored" data-anchor-id="colour-based-on-palette">2. Colour based on palette</h3>
<p>You can also use any of the RColorBrewer predefined colour pallettes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(species_melted, <span class="fu">aes</span>(<span class="at">x =</span> COLUMN_SAMPLES, <span class="at">y=</span>COLUMN_SPECIES, <span class="at">fill =</span> value)) <span class="sc">+</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add new line here with + at the end </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Title of graph"</span>, <span class="at">x =</span> <span class="st">"X axis label"</span>, <span class="at">y =</span> <span class="st">"Y axis label"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="heatmap6_ggplot2colours.gif" class="img-fluid" data-group="my-gallery" alt="Simple heatmap and legend"> And that’s it! You’ve represented your data as a heat map.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","closeEffect":"zoom","loop":false,"descPosition":"bottom","openEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>